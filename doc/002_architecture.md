# アーキテクチャ設計

## 全体構成
```
[ユーザー] <-> [Next.js Frontend] <-> [Next.js API Routes] <-> [変換サービス] <-> [Cloud Storage]
```

## コンポーネント詳細

### フロントエンド (Next.js)
- React + TypeScript による実装
- UIライブラリ: Tailwind CSS + shadcn/ui
- URLフォーム、変換ステータス表示、ダウンロードボタン
- 非同期処理のステータス管理: React Query
- フォームバリデーション: zod

### バックエンド (Next.js API Routes)
- YouTube URL検証 API
- 動画情報取得 API
- 変換リクエスト API
- 変換ステータス確認 API
- ダウンロードURL生成 API

### 変換サービス
- Cloud Run または Cloud Functions 上に構築
- yt-dlp による動画データ取得
- ffmpeg による音声抽出・変換
- 非同期処理のキュー管理
- 一時ファイル管理

### ストレージ
- Cloud Storage バケットでの変換済みファイル保管
- 署名付きURLによる安全なダウンロード提供
- Cloud Scheduler + Cloud Functions によるファイル自動削除

## データフロー
1. ユーザーがYouTube URLを入力
2. フロントエンドでURL検証
3. バックエンドでメタデータ取得・表示
4. ユーザーが変換リクエスト
5. バックエンドで変換処理をキューに追加
6. 変換サービスが処理を実行
7. 変換完了後、ダウンロードリンク生成
8. ユーザーがファイルをダウンロード

## スケーラビリティ設計
- ステートレスなAPI設計
- Cloud Run の自動スケーリング活用
- 長時間実行タスクの分離
- リソース制限の設定（同時変換数制限など）

## セキュリティ設計
- CORS設定による不正アクセス防止
- レート制限の実装
- 署名付きURLによる一時的なアクセス許可
- バックエンド検証による不正URLのフィルタリング 