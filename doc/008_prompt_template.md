# YouTube to MP3 Converter - Composer Agent プロンプト

以下は、YouTube to MP3 Converterアプリケーションを開発するためのComposer Agent用プロンプトテンプレートです。このプロンプトを使用して、構成済みのエージェントに完全なアプリケーションの開発を依頼できます。

```
# YouTube to MP3 Converter 開発プロジェクト

## プロジェクト概要
YouTubeの動画URLを指定したら、その音声部分をMP3形式に変換してダウンロードできるWebアプリケーションを開発してください。このアプリケーションはGoogle Cloud上で低コストで運用し、Next.jsをフロントエンドとバックエンドの両方に使用します。

## 技術スタックの要件
- **フロントエンド・バックエンド**: Next.js（App Routerを使用）
- **UIライブラリ**: Tailwind CSS + shadcn/ui
- **型システム**: TypeScript
- **パッケージマネージャー**: bun
- **インフラ**: Google Cloud (Cloud Run, Cloud Storage)
- **動画処理ライブラリ**: youtube-dl/yt-dlp + ffmpeg

## 主要機能
1. YouTubeのURLを入力するためのフォーム
2. 入力されたURLから動画情報（タイトル、サムネイル、時間など）を取得して表示
3. MP3への変換処理（yt-dlpとffmpegを使用）
4. 変換済みファイルをダウンロードできる機能
5. 変換処理の進捗状況表示
6. 変換履歴の表示（オプション）
7. レスポンシブデザイン対応

## アーキテクチャ
メインアプリケーション（Next.js）とは別に、変換処理を担当する独立したマイクロサービスを作成し、Cloud Run上にデプロイします。これにより、リソース集約的な変換処理をメインアプリから分離します。変換されたファイルはCloud Storageに保存し、署名付きURLでダウンロードを提供します。

## セキュリティ要件
1. 入力されたURLの検証とサニタイズ
2. API呼び出しのレート制限
3. 署名付きURLによるファイルアクセス制限
4. サービス間通信の認証
5. 定期的なファイルクリーンアップ（24時間以上経過したファイル）

## パフォーマンス要件
1. 変換処理の非同期実行
2. 同じビデオのリクエストに対するキャッシング
3. Cloud Runの自動スケーリングを活用した負荷分散

## UIデザイン要件
1. モダンでシンプルなデザイン
2. ダークモード対応
3. 処理状況を視覚的に表示するプログレスバー
4. スマートフォンやタブレットでの使いやすさ

## デプロイ要件
1. Google Cloud Run上に全てのサービスをデプロイ
2. GitHub ActionsによるCI/CD設定
3. 自動テストの実装
4. 環境変数の適切な管理

## 制約事項と留意点
1. YouTubeの利用規約に準拠した実装が必要
2. 著作権で保護されたコンテンツの取り扱いに関する免責事項を表示
3. 大量のリクエストによるサービス乱用を防ぐための対策を実装
4. リソース使用量を最小限に抑えてコスト効率の良い実装

このプロジェクトの最終的なゴールは、ユーザーがシンプルなインターフェースでYouTube動画から音声をMP3形式で抽出し、ダウンロードできるサービスを提供することです。また、Google Cloud上で効率的に運用できるアーキテクチャを実装することも重要です。
```

## プロンプト実行時の補足説明と期待される成果物

### 補足説明

1. **開発環境のセットアップ**
   - Next.jsプロジェクトのスキャフォールディング
   - 必要なパッケージのインストール（yt-dlp, ffmpeg, Cloud Storage SDKなど）
   - 開発環境の設定とディレクトリ構造の構築

2. **フロントエンド実装**
   - URLフォームとバリデーション
   - 動画情報表示コンポーネント
   - 変換状態表示コンポーネント
   - ダウンロードボタン実装
   - レスポンシブデザインの適用

3. **バックエンド実装**
   - APIエンドポイント設計と実装
   - yt-dlpとffmpegの連携
   - Cloud Storageとの連携
   - エラーハンドリング
   - レート制限の実装

4. **変換サービスの実装**
   - 独立したサービスの構築
   - 非同期処理の実装
   - 進捗状態の管理
   - メインアプリケーションとの連携

5. **セキュリティ実装**
   - 入力検証
   - サービス間認証
   - ファイルアクセス制御
   - 脆弱性対策

6. **デプロイ設定**
   - Google Cloudへのデプロイ設定
   - CI/CD パイプラインの構築
   - 環境変数と機密情報の管理

### 期待される成果物

1. **アプリケーションコード**
   - Next.jsベースのウェブアプリケーション
   - 変換サービスのコード
   - 設定ファイル（環境変数、デプロイ設定など）

2. **ドキュメント**
   - README（プロジェクト概要、セットアップ手順）
   - アーキテクチャ図
   - API仕様書
   - デプロイ手順

3. **デプロイ設定ファイル**
   - Dockerfiles
   - Cloud Run設定
   - GitHub Actions ワークフロー定義

## 注意事項

- YouTube APIの利用制限に注意し、youtube-dl/yt-dlpの使用方法を確認すること
- 著作権に関する免責事項を明確に表示すること
- Google Cloudのリソース使用量とコストを最適化すること
- セキュリティ対策を適切に実装すること